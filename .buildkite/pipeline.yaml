steps:
  - name: ":python:"
    command: "ls"
  - name: "login to ecr"
    command: "aws ecr get-login-password --region us-east-1 | docker login --username AWS --password-stdin 853973692277.dkr.ecr.us-east-1.amazonaws.com"
  - name: "docker build"
    commands: 
      - "mkdir s3"
      - "aws s3 cp s3://adarsh-code-source-bucket-2/j/ s3  --recursive"
      - "docker build . -t adarsh-repo:latest"
  - name: "tag image"
    command: "docker tag adarsh-repo:latest 853973692277.dkr.ecr.us-east-1.amazonaws.com/adarsh-repo:latest"
  - name: "push image"
    command: "docker push 853973692277.dkr.ecr.us-east-1.amazonaws.com/adarsh-repo:latest"
  - name: "image cleanup"
    command: "docker image prune -a --force"